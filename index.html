<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name = "viewport" content = "width=device-width",initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">    
    <link rel="stylesheet" type="text/css" href="style.css">
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
   
    <title>4K Television Ratings</title>
</head>
<body>
  <div class ="container">
    <br><br>
    <h3 class = "hr">Rate Cricket Player</h3>
    <div class ="form-group">
      <select id = "player-select" class ="form-control
        custom-select">
        <option value = "0" disabled selected>Select Player</option>
        <option value = "sachin">Sachin Ramesh Tendulkar </option>  
        <option value = "dhoni">Mahendra Singh Dhoni </option>  
        <option value = "virat">Virat Kohli </option>  
        <option value = "hardik">Hardik Pandya  </option>  
        <option value = "rohit">Rohit Sharma </option>    
      </select>
    </div>

    <div class ="form-group">
        <input type = "number" id = "rating-control" class = "form-control"  step="0.1" max = "5" placeholder = "Rate 1 - 5" disabled>

    </div>
    <table class = "table table-striped">
         <thead>
             <tr>
                 <th>4K Television</th>
                 <th>Rating</th>
             </tr>
         </thead>
         <tbody>
             <tr class ="sachin">
                 <td>Sachin Ramesh Tendulkar</td>
                 <td>
                     <div class ="stars-outer">
                        <div class ="stars-inner">
                       </div>
                     </div>
                      <span class = "number-rating">                         
                      </span>
                 </td>
             </tr>
             <tr class ="dhoni">
                 <td>Mahendra Singh Dhoni </td>
                 <td>
                     <div class ="stars-outer">
                         <div class ="stars-inner">
                         </div>
                     </div>
                     <span class = "number-rating">                         
                     </span>
                 </td>
             </tr>
             <tr class ="virat">
                 <td>Virat Kohli</td>
                 <td>
                     <div class ="stars-outer">
                        <div class ="stars-inner">
                       </div>
                     </div>
                     <span class = "number-rating">                         
                     </span>
                 </td>
             </tr>
             <tr class ="hardik">
                    <td>Hardik Pandya </td>
                    <td>
                        <div class ="stars-outer">
                           <div class ="stars-inner">
                          </div>
                        </div>
                        <span class = "number-rating">                         
                        </span>
                    </td>
                </tr>
             <tr class ="rohit">
                 <td>Rohit Sharma</td>
                 <td>
                     <div class ="stars-outer">
                        <div class ="stars-inner">
                       </div>
                     </div>
                     <span class = "number-rating">                         
                     </span>
                 </td>
             </tr>
         </tbody>
     </table>
    </div>
    
    <script>
         //Initial Ratings
         //Associative array
         const ratings = {
             sachin : 4.5,
             dhoni: 4.7,
             virat : 4.3,
             hardik : 3.6,
             rohit : 4.1
         }

         //Total Stars
         const starsTotal = 5;
         
         //Run getRatings when DOM loads
         document.addEventListener('DOMContentLoaded',getRatings);


         //Form Elements
         const playerSelect = document.getElementById('player-select');
         const ratingControl = document.getElementById('rating-control');

         //Init Product
          var player;

        //Product select change
        playerSelect.addEventListener('change' ,(e) => { player = e.target.value;
                                                          ratingControl.disabled = false;
                                                          ratingControl.value = ratings[player]; 
                                                        });
        
        //Rating Control Changes
        ratingControl.addEventListener('blur', (e) => {
                                                         const rating = e.target.value;
                                                         if( rating > 5)
                                                         {
                                                             alert('PLease rate btw 1-5');
                                                             return;
                                                         } 
                                                         ratings[player] = rating;
                                                         getRatings();
        });

         //Get Ratings
         function getRatings()
         {
            // console.log('ran');
            //Acessing associative array elements
            for(var rating in ratings)
            {
                //console.log(ratings[rating]);
                //Get Percentage
                const starPercentage = (ratings[rating]/starsTotal)*100;
                
                //console.log(starPercentage);
            
                //Round that to nearest 10
                const starPercentageRounded = `${Math.round(starPercentage / 10) * 10}%`;
  
                //console.log(starPercentageRounded);
                //Identifying particular type of object
                document.querySelector(`.${rating} .stars-inner`).style.width = starPercentageRounded;
 
                //Add number rating
                document.querySelector(`.${rating} .number-rating`).innerHTML = ratings[rating];

            }
         }

    </script>
</body>
</html>